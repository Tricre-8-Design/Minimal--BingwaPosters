# Create Test Payment Session Record

## Goal

Insert a test record into the `generated_posters` table in Supabase with a specific session ID (`session_1769369623474_t2i10tiwa`) and status `AWAITING_PAYMENT`. This record will persist (session never expires in code logic, though DB doesn't enforce expiration by default) to allow repeated payment flow testing without regenerating a poster.

## Assumptions

* The `generated_posters` table exists and matches the schema inferred from the codebase.

* The `session_id` column is unique.

* Access to Supabase is possible via in build intergration, SQL script or a temporary API route.

* The user wants this done via a method that executes the insertion (SQL script is the standard way for this).

## Plan

1. Create Seed Script

   * Files: `scripts/seed-poster.ts`

   * Change: Create a script that initializes Supabase client with process.env vars and inserts the record using `upsert` to handle duplicates.

   * Verify: `ls scripts/seed-poster.ts`.

2. Execute Seed Script

   * Files: N/A

   * Change: Run `npx tsx scripts/seed-poster.ts`.

   * Verify: Check output for "Success" message.

3. Cleanup

   * Files: `scripts/seed-poster.ts`

   * Change: Delete the script after successful execution.

   * Verify: `ls scripts/seed-poster.ts` (should not exist).

## Risks & mitigations

* **Env Vars**: Script needs `NEXT_PUBLIC_SUPABASE_URL` and `SUPABASE_SERVICE_ROLE_KEY`. I will read `.env.local` to ensure they are available to the script (via `dotenv`).

* **Duplicate Key**: The script will use `upsert` or `onConflict` to avoid errors if run multiple times.

## Rollback plan

* Delete the inserted record manually if needed using SQL: `DELETE FROM generated_posters WHERE session_id = 'session_1769369623474_t2i10tiwa';`

